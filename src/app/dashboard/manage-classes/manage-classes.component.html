<div class="container">
    <!-- Page Header -->
    <div class="header">
      <div>
        <h1>Classroom Management</h1>
        <p>Create, view, and manage your classes and student enrollments.</p>
      </div>
      <button class="btn btn-primary" (click)="openCreateModal()">
        <i class="fas fa-plus"></i> Create New Class
      </button>
    </div>
  
    <!-- Main Content Grid -->
    <div class="content-grid">
      <!-- List of Classes -->
      <div class="class-list-panel">
        <div class="panel-header">
          <h3>All Classes ({{ classes.length }})</h3>
        </div>
        <div class="class-list">
          <div *ngIf="classes.length === 0" class="empty-state">
            <i class="fas fa-school"></i>
            <p>No classes yet. Click "Create New Class" to get started!</p>
          </div>
          <div *ngFor="let class of classes" 
               class="class-item" 
               [class.selected]="selectedClass?.id === class.id"
               (click)="selectClass(class)">
            <div class="class-item-icon"><i class="fas fa-chalkboard"></i></div>
            <div class="class-item-details">
              <span class="class-name">{{ class.name }}</span>
              <span class="student-count">{{ class.students.length }} Students</span>
            </div>
            <i class="fas fa-chevron-right"></i>
          </div>
        </div>
      </div>
  
      <!-- Class Details Panel -->
      <div class="class-details-panel">
        <div *ngIf="!selectedClass" class="no-class-selected">
          <i class="fas fa-mouse-pointer"></i>
          <h2>Select a class</h2>
          <p>Choose a class from the left panel to view its details and manage students.</p>
        </div>
        
        <div *ngIf="selectedClass" class="details-content">
          <div class="panel-header">
            <div>
              <h3>{{ selectedClass.name }}</h3>
              <p class="class-description">{{ selectedClass.description }}</p>
            </div>
            <button class="btn-back" (click)="unselectClass()">
              <i class="fas fa-times"></i> Close
            </button>
          </div>
          
          <div class="class-code-section">
            <span>Classroom Code:</span>
            <div class="code-box" (click)="copyCode(selectedClass.classCode)" title="Click to copy">
              <strong>{{ selectedClass.classCode }}</strong>
              <i class="far fa-copy"></i>
            </div>
          </div>
          
          <div class="student-list-section">
            <div class="student-list-header">
              <h4>Enrolled Students ({{ selectedClass.students.length }})</h4>
              <button class="btn btn-secondary" (click)="openAddStudentModal()">
                <i class="fas fa-user-plus"></i> Add Student
              </button>
            </div>
            <div class="student-list">
              <div *ngIf="selectedClass.students.length === 0" class="empty-state small">
                  <p>No students have been added to this class yet.</p>
              </div>
              <table *ngIf="selectedClass.students.length > 0" class="student-table">
                  <thead>
                    <tr>
                      <th>Name</th>
                      <th>Email</th>
                      <th>Progress</th>
                      <th>Actions</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr *ngFor="let student of selectedClass.students">
                      <td>{{ student.name }}</td>
                      <td>{{ student.email }}</td>
                      <td>
                        <div class="progress-bar">
                          <div class="progress" [style.width.%]="student.progress"></div>
                        </div>
                        {{ student.progress }}%
                      </td>
                      <td>
                        <button class="btn-remove" (click)="handleRemoveStudent(student.id)" title="Remove Student">
                          <i class="fas fa-trash-alt"></i>
                        </button>
                      </td>
                    </tr>
                  </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Create Class Modal -->
  <div *ngIf="isCreateModalOpen" class="modal-overlay" (click)="closeCreateModal()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h2>Create New Class</h2>
        <button class="btn-close" (click)="closeCreateModal()">&times;</button>
      </div>
      <div class="modal-body">
        <form (ngSubmit)="handleCreateClass()">
          <div class="form-group">
            <label for="className">Class Name *</label>
            <input type="text" id="className" [(ngModel)]="newClassName" name="className" required>
          </div>
          <div class="form-group">
            <label for="classDescription">Description</label>
            <textarea id="classDescription" [(ngModel)]="newClassDescription" name="classDescription" rows="4"></textarea>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" (click)="closeCreateModal()">Cancel</button>
            <button type="submit" class="btn btn-primary" [disabled]="!newClassName.trim()">Create Class</button>
          </div>
        </form>
      </div>
    </div>
  </div>
  
  <!-- Add Student Modal -->
  <div *ngIf="isAddStudentModalOpen" class="modal-overlay" (click)="closeAddStudentModal()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h2>Add Student to "{{ selectedClass?.name }}"</h2>
        <button class="btn-close" (click)="closeAddStudentModal()">&times;</button>
      </div>
      <div class="modal-body">
        <form (ngSubmit)="handleAddStudent()">
          <div class="form-group">
            <label for="studentName">Student Name *</label>
            <input type="text" id="studentName" [(ngModel)]="newStudentName" name="studentName" required>
          </div>
          <div class="form-group">
            <label for="studentEmail">Student Email *</label>
            <input type="email" id="studentEmail" [(ngModel)]="newStudentEmail" name="studentEmail" required>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" (click)="closeAddStudentModal()">Cancel</button>
            <button type="submit" class="btn btn-primary" [disabled]="!newStudentName.trim() || !newStudentEmail.trim()">Add Student</button>
          </div>
        </form>
      </div>
    </div>
  </div>
  